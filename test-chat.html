<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Chat Test</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .bubble { padding: 8px 12px; margin: 8px; border-radius: 8px; max-width: 70%; }
    .user { background: #2563eb; color: white; margin-left: auto; }
    .bot { background: #eee; }
  </style>
</head>
<body>

<h2>Athena Donor Chatbot (Test)</h2>

<div id="chat"></div>

<input id="msg" placeholder="Type a message..." style="width: 60%; padding: 8px;">
<button onclick="sendChat()">Send</button>

<script>
  let sessionId = null;

  function addBubble(text, role) {
    const div = document.createElement("div");
    div.className = "bubble " + role;
    div.innerText = text;
    document.getElementById("chat").appendChild(div);
  }

  async function sendChat() {
    const text = document.getElementById("msg").value;
    document.getElementById("msg").value = "";
    if (!text.trim()) return;

    addBubble(text, "user");

    const res = await fetch("http://localhost:8000/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        message: text,
        language: "en",
        session_id: sessionId
      })
    });

    const data = await res.json();
    sessionId = data.session_id;

    addBubble(data.response, "bot");
  }
</script>

</body>
</html>
